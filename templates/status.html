{% extends "base.html" %}
{% block nav_options %}
  <a href="/student_dashboard" class="hover:text-yellow-300 transition">Home</a>
  <a href="/about" class="hover:text-yellow-300 transition">About</a>
  <a href="/rate" class="hover:text-yellow-300 transition">Rate</a>
  <a href="/logout" class="hover:text-yellow-300 transition">Logout</a>
{% endblock %}

{% block content %}
<div data-aos="fade-up">
  <h2 class="text-2xl font-bold text-indigo-600 mb-4">ðŸ“Œ My Applications</h2>

  {% if applications %}
    <div class="space-y-4">
      {% for a in applications %}
        <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow hover:scale-102 transition" data-aos="fade-right">
          <div class="flex justify-between items-start">
            <div>
              <h3 class="font-bold text-indigo-600">{{ a.placement.company }} â€” {{ a.placement.title }}</h3>
              <p class="text-sm text-gray-500">Applied: {{ a.applied_at.strftime('%Y-%m-%d %H:%M') }}</p>
              <p class="text-sm text-gray-400 mt-1">Deadline: {{ a.placement.deadline }}</p>
            </div>
            <div class="text-right">
              {% if a.status == "Applied" %}
                <span class="px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full">ðŸŸ¡ Applied</span>
              {% elif a.status == "Shortlisted" %}
                <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full">ðŸ”µ Shortlisted</span>
              {% elif a.status == "Selected" %}
                <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full">ðŸŸ¢ Selected</span>
              {% else %}
                <span class="px-3 py-1 bg-red-100 text-red-800 rounded-full">ðŸ”´ Rejected</span>
              {% endif %}
            </div>
          </div>

          <!-- âœ… Inner block must close properly -->
          {% if apps %}
            <div class="space-y-6 mt-4">
              {% for app in apps %}
                <div class="bg-gradient-to-r from-green-500 to-teal-600 text-white p-6 rounded-xl shadow-lg">
                  <h2 class="text-2xl font-bold">
                    {{ app.placement.company }} - {{ app.placement.role }}
                  </h2>
                  <p>Status: <span class="font-semibold">{{ app.status }}</span></p>
                </div>
              {% endfor %}
            </div>
          {% endif %}
          <!-- âœ… End inner block -->

          <!-- Progress bar visual -->
          <div class="mt-4">
            <div class="w-full bg-gray-200 h-2 rounded-full overflow-hidden">
              {% set steps = ['Applied','Shortlisted','Selected'] %}
              {% set idx = steps.index(a.status) if a.status in steps else -1 %}
              {% set percent = ((idx+1) / len(steps) * 100) if idx>=0 else 100 %}
              <div class="h-2 rounded-full" style="width: {{ percent }}%; background: linear-gradient(90deg,#f59e0b,#10b981); transition: width .6s ease;"></div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p>You haven't applied anywhere yet.</p>
  {% endif %}
</div>
{% endblock %}
